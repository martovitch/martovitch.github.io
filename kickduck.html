<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kickduck</title>
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–ª–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        body {
            background-color: white;
            margin: 0;
            overflow: hidden;
            cursor: none;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è */
        #gameCanvas {
            background-color: white;
            border: none;
            cursor: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∫—É—Ä—Å–æ—Ä–∞ (—Å–º–∞–π–ª–∏–∫–∞ –Ω–æ–≥–∏) */
        #customCursor {
            position: absolute;
            width: auto;
            height: auto;
            pointer-events: none;
            transform: translate(-50%, -50%);
            font-size: 2.5em;
            line-height: 0.9;
            white-space: pre;
            text-align: left;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—á–µ—Ç—á–∏–∫–æ–≤ */
        #scoreContainer {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }
        
        #scoreDisplay, #bestScoreDisplay {
            font-family: monospace;
            font-size: 1.5em;
            color: black;
            user-select: none;
            margin: 5px 0;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <div id="customCursor">
        <span>ü¶µüèª</span>
    </div>
    <canvas id="gameCanvas"></canvas>
    <div id="scoreContainer">
        <div id="scoreDisplay">–°—á–µ—Ç: 0</div>
        <div id="bestScoreDisplay">–õ—É—á—à–∏–π —Å—á–µ—Ç: 0</div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const customCursor = document.getElementById('customCursor');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const bestScoreDisplay = document.getElementById('bestScoreDisplay');

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        let particle = null; // –§–∏–≥—É—Ä–∞
        let computer = null; // –ö–æ–º–ø—å—é—Ç–µ—Ä

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–π–º–µ—Ä–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
        let nextComputerSpawnTime = 0;
        const minSpawnTime = 2000; // 2 —Å–µ–∫—É–Ω–¥—ã
        const maxSpawnTime = 4000; // 4 —Å–µ–∫—É–Ω–¥—ã

        // –û–±—ä–µ–∫—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –º—ã—à–∏
        let mouse = {
            x: undefined,
            y: undefined
        };
        let score = 0;
        let bestScore = 0;

        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ –±—É—Ñ–µ—Ä–æ–≤
        const particleSize = 50;
        const hitBuffer = 75; // –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –¥–ª—è –∫–ª–∏–∫–∞ –ø–æ —Ñ–∏–≥—É—Ä–µ
        const computerHitBuffer = 20; // –ë—É—Ñ–µ—Ä –¥–ª—è —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º

        // –ö–ª–∞—Å—Å –¥–ª—è —Ñ–∏–≥—É—Ä—ã
        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = particleSize;
                this.velocity = { x: 0, y: 0 };
                this.gravity = 0.02;
                this.friction = 0.8;
                this.color = 'red';
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.font = `${this.size}px sans-serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('‚±≠Õû Ã∂Õû Ã∂Õû Ã∂Õû ŸÑ⁄∫Õû', this.x, this.y);
            }

            update() {
                this.velocity.y += this.gravity;
                this.y += this.velocity.y;
                this.x += this.velocity.x;

                // –û—Ç—Å–∫–æ–∫ –æ—Ç –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã
                if (this.y - this.size / 2 < 0) {
                    this.velocity.y *= -this.friction;
                    this.y = this.size / 2;
                }

                // –û—Ç—Å–∫–æ–∫ –æ—Ç –ª–µ–≤–æ–π –∏ –ø—Ä–∞–≤–æ–π –≥—Ä–∞–Ω–∏—Ü
                if (this.x - this.size / 2 < 0) {
                    this.velocity.x = Math.abs(this.velocity.x) * this.friction;
                    this.x = this.size / 2; 
                } else if (this.x + this.size / 2 > canvas.width) {
                    this.velocity.x = -Math.abs(this.velocity.x) * this.friction;
                    this.x = canvas.width - this.size / 2;
                }

                // –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∏–≥—É—Ä—ã, –µ—Å–ª–∏ –æ–Ω–∞ –ø–∞–¥–∞–µ—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —ç–∫—Ä–∞–Ω–∞
                if (this.y > canvas.height + this.size) {
                    particle = null;
                    score = 0; // –°–±—Ä–æ—Å —Å—á–µ—Ç–∞
                    updateScoreDisplay(); 
                } else {
                    this.draw();
                }
            }
        }

        // –ö–ª–∞—Å—Å –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
        class Computer {
            constructor() {
                this.size = 50;
                this.x = Math.random() * (canvas.width - this.size) + this.size / 2;
                this.y = Math.random() * (canvas.height - this.size) + this.size / 2;
            }

            draw() {
                ctx.font = `${this.size}px sans-serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('üíª', this.x, this.y);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—á–µ—Ç–∞
        function updateScoreDisplay() {
            scoreDisplay.textContent = `–°—á–µ—Ç: ${score}`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª—É—á—à–µ–≥–æ —Å—á–µ—Ç–∞
        function updateBestScoreDisplay() {
            bestScoreDisplay.textContent = `–õ—É—á—à–∏–π —Å—á–µ—Ç: ${bestScore}`;
        }

        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–≥—Ä—ã
        function init() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            particle = null;
            computer = null;
            score = 0;
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ª—É—á—à–µ–≥–æ —Å—á–µ—Ç–∞ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
            const savedBestScore = localStorage.getItem('bestScore');
            if (savedBestScore !== null) {
                bestScore = parseInt(savedBestScore, 10);
            }
            
            updateScoreDisplay();
            updateBestScoreDisplay();
            nextComputerSpawnTime = Date.now() + Math.random() * (maxSpawnTime - minSpawnTime) + minSpawnTime;
        }

        // –ì–ª–∞–≤–Ω—ã–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function animate() {
            requestAnimationFrame(animate);
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
            if (Date.now() >= nextComputerSpawnTime) {
                computer = new Computer();
                nextComputerSpawnTime = Date.now() + Math.random() * (maxSpawnTime - minSpawnTime) + minSpawnTime;
            }
            if (computer) {
                computer.draw();
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ –º—ã—à–∏ —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º
                const distance = Math.hypot(mouse.x - computer.x, mouse.y - computer.y);
                if (distance < computer.size / 2 + computerHitBuffer) {
                    init();
                }
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ñ–∏–≥—É—Ä—ã
            if (particle) {
                particle.update();
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', () => {
            init();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–≤–∏–∂–µ–Ω–∏—è –º—ã—à–∏
        window.addEventListener('mousemove', (event) => {
            mouse.x = event.clientX;
            mouse.y = event.clientY;
            customCursor.style.left = `${mouse.x}px`;
            customCursor.style.top = `${mouse.y}px`;
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
        canvas.addEventListener('click', (event) => {
            if (!particle) {
                // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–∏–≥—É—Ä—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ
                const x = Math.random() * (canvas.width - particleSize) + particleSize / 2;
                const y = Math.random() * (canvas.height - particleSize) + particleSize / 2;
                particle = new Particle(x, y);
            } else {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–ª–∏–∫ –ø–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ–∏–≥—É—Ä–µ
                const clickX = event.clientX;
                const clickY = event.clientY;

                if (
                    clickX > particle.x - particle.size / 2 - hitBuffer &&
                    clickX < particle.x + particle.size / 2 + hitBuffer &&
                    clickY > particle.y - particle.size / 2 - hitBuffer &&
                    clickY < particle.y + particle.size / 2 + hitBuffer
                ) {
                    const dx = clickX - particle.x;
                    const bounceFactor = 0.15;
                    particle.velocity.y = -5; // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –æ—Ç—Å–∫–æ–∫
                    particle.velocity.x = dx * bounceFactor; // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –æ—Ç—Å–∫–æ–∫
                    score++;
                    updateScoreDisplay();
                    
                    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ —Å—á–µ—Ç–∞
                    if (score > bestScore) {
                        bestScore = score;
                        localStorage.setItem('bestScore', bestScore);
                        updateBestScoreDisplay();
                    }
                }
            }
        });

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            init();
            animate();
        };
    </script>
</body>
</html>
